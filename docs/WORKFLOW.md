# 作業手順書（小さい構成で順番に動作確認しながら進める）

## 目的
最小構成で順番に動作確認を行い、段階的に機能を積み上げる。

## 全体ルール
- 1ステップでやることは最小限にする（変更が少ないほど確認が楽）。
- 各ステップの最後に動作確認を行い、結果をチェックリストで記録する。
- 変更がまとまったら都度コミットする（日本語メッセージでOK）。

---

## Step 0: ベースライン確認（現状把握）
変更・追加内容:
- なし

あなたが行う作業:
- `apps/extention` がビルド可能か確認
- 既存の拡張が読み込めるか確認

完了チェックリスト:
- `apps/extention` のビルドが通る
- 既存拡張がChromeに読み込める

---

## Step 1: 拡張の最小起動確認
変更・追加内容:
- `apps/extention/public/manifest.json` を最小構成で読み込み確認できる状態にする
- 余計な権限や未使用エントリは削減

あなたが行う作業:
- 拡張の「パッケージ化されていない拡張機能を読み込む」で読み込み
- 拡張のアイコンが表示されるか確認

完了チェックリスト:
- 読み込みエラーが出ない
- 拡張のアイコンが表示される
- Chromeの拡張詳細でエラーが出ない

---

## Step 2: 背景処理の最小確認（拡張側）
変更・追加内容:
- `apps/extention/background.ts` で起動ログを出す
- 余計な処理は持たせない

あなたが行う作業:
- Chrome拡張のサービスワーカーを起動（詳細画面で確認）
- `chrome://extensions` でログを確認

完了チェックリスト:
- 起動ログが確認できる
- エラーが出ない

---

## Step 3: YouTubeタブ判定の最小確認
変更・追加内容:
- 現在タブのURLを取得してYouTubeか判定する
- 判定結果をログに出す

あなたが行う作業:
- YouTubeタブ/非YouTubeタブを開いて切り替え
- 拡張ログで判定結果を確認

完了チェックリスト:
- YouTubeタブで `isYouTube=true` が出る
- 非YouTubeで `isYouTube=false` が出る

---

## Step 4: Desktop UI（最小）起動確認
変更・追加内容:
- Desktop UIで「開始/停止」だけの最小UIを用意
- 状態表示の1行を実装

あなたが行う作業:
- Desktopを起動
- ボタン操作で状態が切り替わるか確認

完了チェックリスト:
- UIが起動しクラッシュしない
- 開始/停止で状態が切り替わる

---

## Step 5: Native Messaging 疎通確認（最小）
変更・追加内容:
- 拡張→NativeHostへ「ping」を送信
- NativeHost→拡張へ「pong」を返す

あなたが行う作業:
- 拡張側から送信してログ確認
- NativeHost側ログで受信確認

完了チェックリスト:
- 拡張→NativeHostが届く
- NativeHost→拡張が返る
- どちらもエラーが出ない

---

## Step 6: 音声入力の最小確認（方式決定）
変更・追加内容:
- 方式選定（tabCapture or WASAPI）
- 選定した方式で最小の録音/取得ができることを確認

あなたが行う作業:
- テスト用のYouTube動画を再生
- 音声入力が取れているか確認

完了チェックリスト:
- 連続した音声入力が取得できる
- 停止で入力が止まる

---

## Step 7: ASRの最小確認
変更・追加内容:
- ASRを拡張内で動かし、最小の音声→テキストを確認
- 暫定で「マイク入力」を使う（ASRタブから起動）

あなたが行う作業:
- 拡張ポップアップからASRタブを開く
- ASRタブで開始/停止し、結果ログを確認

完了チェックリスト:
- ASRタブのログに部分/確定結果が出る
- 停止でASRが止まる

---

## Step 8: 翻訳の最小確認
変更・追加内容:
- ASR結果を簡易辞書で英→日変換
- 翻訳結果をログで確認

あなたが行う作業:
- ASRタブで英語を話し、翻訳ログを確認

完了チェックリスト:
- 翻訳ログが出る
- エラーが出ない

---

## Step 9: 履歴ログの最小確認
変更・追加内容:
- 確定翻訳だけ履歴に積む

あなたが行う作業:
- UIで履歴が増えるか確認

完了チェックリスト:
- 確定翻訳が履歴に追加される
- UIが重くならない

---

## コミット運用（推奨）
各ステップの完了時にコミット。
例:
- `Step1: 拡張の最小起動確認`
- `Step2: 背景処理の最小ログ`
